import { FullScreenCode, Head, Image, SplitRight, Box } from 'mdx-deck'
import Theme from './src/index'
import { Card, SplitLeftAlign } from './src/index'
export const theme = Theme

<Head>
<title>Moving the AgilityNerd Blog to GatsbyJS</title>
</Head>

---

# Moving the AgilityNerd Blog to GatsbyJS

## Steve Schwarz

### NWCJS Meetup - 2019-11-21

---

<SplitRight>


![](./images/steve-snap.jpg)


#### @steveaschwarz

Professional software developer since 1991.

15 yr C/C++ OO client-server dev: factory automation and futures/options trading.

12+ yr web dev: Python, JavaScript, Angular, VueJS, and Postgres

20+ yr hobby: dog agility and web dev: agilitynerd.com,  tech.agilitynerd.com, googility.com, agilitycourses.com & agilitycoursemaster.com

</SplitRight>

---
import legacyagilitynerd from './images/legacy-agilitynerd.png'

<SplitLeftAlign>

  <div style="text-align: left;">
    <h2>AgilityNerd Blog</h2>
    <ul>
      <li>Oldest dog agility blog</li>
      <li>Designed to be a reference site with pages dynamically cross linked</li>
      <li>800 blog posts</li>
      <li>1600 total pages</li>
      <li>12,000 FB followers</li>
    </ul>
  </div>

  <Image src={legacyagilitynerd} size="contain" style={{height: '100vh'}}>
  </Image>

</SplitLeftAlign>

---

## Why Change?

- Platform complicated/locked-in => cost
- Terrible authoring experience
- Poor performance
- FTP deploy

---

## Existing Technology

<SplitLeftAlign>

- Content in directories of flat files
- frontmatter/HTML fragment files
- Perl CGI Script (Blosxom) / plugins
- FastCGI


- NGINX caching
- FTP Upload
- No preview
- HTML authoring

</SplitLeftAlign>

---

## Decided on a JAMstack Solution

- JavaScript
- APIs
- Markup

Provides:

- Performance: Generate all/most pages at build time
- Scaling: Stateless servers and CDNs
- Security: No server code running smaller attack surface
- Developer Experience

https://jamstack.org

---

## Gatsby JS

Open source https://gatsbyjs.org supported by commercial offerings https://gatsbyjs.com

Fits the JAMStack model:
- Static site generator
- Combine data sources
- Generate all pages
- Unified data access model: GraphQL Todd Mantel video here
- Git or hook based deploys
- Real time preview

---

## Use Gatsby For:

- Portfolio, brouchure, blogs
- Excels at content obtained at build time
- Shopping site: client side JS to communicate with APIs
- Write Few/Read Many? Just regenerate and deploy

---

Generates

---

## Setting Up

- install node
- install git
```
mkdir my-project && cd my-project

npm install -g gatsby-cli

gatsby develop
```

---

## Starters
blog starter

- pages
- markdown

---

## Set up data sources

`gatsby-config.js`

- Markdown/images from file system
- CMS API(s) to fetch content
- Favorites from google analytics
- YAML, CSV, JSON files

---

## Using Data Sources

- Gatsby data sources create GraphQL nodes
- Query the data via GraphQL
- Interactive testing via GraphiQL explorer
- Generate pages using Gatsby API

---

## `gatsby-node.js`

```
exports.createPages = async ({ graphql, actions }) => {
  const result = await graphql(
    `{
      allMdx(sort: {fields: [frontmatter___date], order: DESC},
      filter: {frontmatter: {date: {ne: null}, draft: {ne: true}}}) {
        edges {
          node {
            id
            fields {
              slug
            }
            frontmatter {
              title
              date
              tags
            }
          }
        }
      }
      tagsGroup: allMdx(
        filter: {frontmatter: {date: {ne: null}, draft: {ne: true}}}) {
        group(field: frontmatter___tags) {
          fieldValue
        }
      }
    }`
  )
```

---

<FullScreenCode>

```
// Create individual blog posts pages.
posts.forEach((post, index) => {
  const previous = index === posts.length - 1 ? null : posts[index + 1].node
  const next = index === 0 ? null : posts[index - 1].node
  const slug = post.node.fields.slug
  createPage({
    path: slug,
    component: slug.includes('/static/') ? staticPost : blogPost,
    context: {
      slug: slug,
      previous,
      next,
    },
  })
})
```

</FullScreenCode>

---

Templates
blogpost

---

ReactJS Components

```
<TagCloud>
```

---

MDX + React Components


---

## Plugins

- MDX
- Analytics
- Sitemap
- Search
- Offline
- Manifest
- RSS Feeds
- Image Processing
- SASS

---

## Deploy to Netlify

---

## Gatsby Themes

---

## Gatsby Future

- Gatsby Cloud

- Large site performance

---

# Thanks!

---
